<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Deep Learning Project</title>

  <link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css">

  <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@1.0.1"> </script>
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow-models/mobilenet@1.0.0"> </script>
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs"></script>

  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
  <link rel="stylesheet" href="cam.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>





</head>

<body>

  <div class="container">
    <h1>Please Log In and Download you access Token :)</h1>
    <button href="/login">Log in with Spotify</button>
    <button onclick="saveTokenAsFile(getHashParams().access_token)">Download Access Token</button>

  </div>

  <script src="cam.js"></script>
  <canvas id="c" width="2000" height="2000"></canvas>
  <img src="./spotify-logo.png" alt="" class="spotify">

  <div class="video-player" align="center">
    <p id="prediction"></p>
    <video id="player" controls></video>
    <div class="player-buttons" align="center">
      <button id="bg-button" class="btn btn-success" onclick="captureBackground()">Capture Background</button>
      <button id="gesture-button" class="btn btn-success" onclick="capture()">Capture Gesture</button>
    </div>
    <p id="countdown" align="center"></p>

    <script>
    function saveTokenAsFile(access_token)
    {
        var textFileAsBlob = new Blob([access_token], {type:'text/plain'});
          var downloadLink = document.createElement("a");
        downloadLink.download = 'Access_Token.txt';
        downloadLink.innerHTML = "Download File";
        if (window.webkitURL != null)
        {
            // Chrome allows the link to be clicked
            // without actually adding it to the DOM.
            downloadLink.href = window.webkitURL.createObjectURL(textFileAsBlob);
        }
        else
        {
            // Firefox requires the link to be added to the DOM
            // before it can be clicked.
            downloadLink.href = window.URL.createObjectURL(textFileAsBlob);
            downloadLink.onclick = destroyClickedElement;
            downloadLink.style.display = "none";
            document.body.appendChild(downloadLink);
        }

        downloadLink.click();
    }

    function getHashParams() {
      var hashParams = {};
      var e, r = /([^&;=]+)=?([^&;]*)/g,
          q = window.location.hash.substring(1);
      while ( e = r.exec(q)) {
         hashParams[e[1]] = decodeURIComponent(e[2]);
      }

      return hashParams;



    }

    var params = getHashParams();


    var access_token = params.access_token, refresh_token = params.refresh_token, error = params.error;


    </script>


  </div>


</body>
</html>
